---
title: jenkins安装
date: 2022-04-25 16:17:35
cover: /img/thumbnail/学习/后端/jenkins/jenkins.png
thumbnail: /img/thumbnail/学习/后端/jenkins/jenkins.png
tags:
- jenkins
toc: true
---

[参考地址](https://jishuin.proginn.com/p/763bfbd7193b)

## <font color=#a862ea>安装jdk</font>

```bash
yum install -y java-1.8.0-openjdk-devel.x86_64
```

检查是否安装成功，java -version

<!--more-->

## <font color=#a862ea>安装jenkins</font>

yum的repo中默认没有Jenkins，需要先将Jenkins存储库添加到yum repos
直接上命令，等待安装即可

```shell
wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo 
rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key
#jenkins 默认安装最新的
yum install jenkins -y 
```

## <font color=#a862ea>启动jenkins</font>

```shell
service jenkins start
```

自动安装的话，默认端口为8080，默认目录：

- 安装目录：/var/lib/jenkins
- 日志目录：/var/log/jenkins/jenkins.log
- 默认配置目录：/etc/sysconfig/jenkins

可修改jenkins用户为root用户、修改端口等

```shell
vim /etc/sysconfig/jenkins
service jenkins restart
```

其中的JENKINS_USER和JENKINS_PORT为用户和端口

如果端口修改没有生效，可以使用如下方法：

```shell
# 进入目录
cd /usr/lib/systemd/system
vim jenkins.service
# 或者
vim /usr/lib/systemd/system/jenkins.service
# 修改为想要的端口
Environment="JENKINS_PORT=9080"
# 重新加载配置文件
systemctl daemon-reload
```

## <font color=#a862ea>激活jenkins</font>

首次登陆jenkins（http://www.zhouhongbin.work:9080/），需要输入密码

在服务器中输入以下命令，找到默认密码

```bash
cat  /var/lib/jenkins/secrets/initialAdminPassword
```

然后注册用户，可以选择admin，之后选择推荐插件安装就好了

## <font color=#a862ea>设置git</font>

由于默认的用户是jenkins，所以生成ssh key要在Jenkins用户的目录下

```shell
su root
cd /var/lib/jenkins/.ssh
ssh-keygen -t rsa -C your-email@sample.com
# 注意下一步提示保存位置的时候，要再输入
/var/lib/jenkins/.ssh/id_rsa
# Enter file in which to save the key (/root/.ssh/id_rsa): /var/lib/jenkins/.ssh/id_rsa
chown jenkins:jenkins id_rsa id_rsa.pub
cat id_rsa.pub
```

将id_rsa.pub（公钥）的内容放到github上的sshkey里，然后将id_rsa（密钥）添加到jenkins的**Credentials**里，这样jenkins才能访问git

